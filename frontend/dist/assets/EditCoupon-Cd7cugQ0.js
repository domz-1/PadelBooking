import{u as e,r as t,C as a,m as o,o as u,j as n,k as s,q as r,b as i,B as l,e as p}from"./index-BChQAjBg.js";import{C as c}from"./CouponsAPI-B3DH21Q0.js";import{_ as d}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as m}from"./AdminLayout-BDbNDvIA.js";import{_ as v}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{_}from"./Form.vue_vue_type_script_setup_true_lang-Dj0hsM9h.js";import"./helpers-BbRepCn0.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";const C={class:"space-y-5 sm:space-y-6"},h={class:"max-w-2xl"},x={__name:"EditCoupon",setup(x){const y=a(),f=l(),g=e(),b=t(y.params.id),w=o(()=>"new"!==b.value),E=o(()=>w.value?"Edit Coupon":"Create Coupon"),j=o(()=>w.value?"Update Coupon Details":"Create New Coupon"),D=t(!1),k=t({}),q=[{key:"code",type:"text",label:"Coupon Code",placeholder:"Enter coupon code (e.g., SUMMER2024)",required:!0,hint:"Unique code that customers will use at checkout"},{key:"discount",type:"number",label:"Discount Percentage",placeholder:"Enter discount percentage",required:!0,min:1,max:100,validation:{min:1,max:100,custom:e=>{const t=parseFloat(e);return isNaN(t)||t<1?"Discount must be at least 1%":!(t>100)||"Discount cannot exceed 100%"}},hint:"Percentage discount applied to the order total"},{key:"expires",type:"date",label:"Expiration Date",required:!0,validation:{custom:e=>{if(!e)return"Expiration date is required";const t=new Date(e),a=new Date;return a.setHours(0,0,0,0),!(t<a)||"Expiration date must be in the future"}},hint:"Coupon will expire after this date"}],B=async()=>{if(w.value){D.value=!0;try{const e=await c.getCoupon(b.value,g.token);k.value=e.data.data.coupon}catch(e){console.error("Error loading coupon:",e),f.push("/coupons")}finally{D.value=!1}}},U=async e=>{D.value=!0;try{const t={code:e.code.toUpperCase(),discount:parseFloat(e.discount),expires:e.expires};w.value?await c.updateCoupon(b.value,t,g.token):await c.createCoupon(t,g.token),f.push("/coupons")}catch(t){console.error("Error saving coupon:",t)}finally{D.value=!1}},P=()=>{w.value&&B()};return u(()=>{B()}),(e,t)=>(p(),n(m,null,{default:s(()=>[r(d,{pageTitle:E.value},null,8,["pageTitle"]),i("div",C,[r(v,{title:j.value},{default:s(()=>[i("div",h,[r(_,{fields:q,initialData:k.value,showSubmitButton:!0,submitButtonText:w.value?"Update Coupon":"Create Coupon",showResetButton:!0,loading:D.value,onSubmit:U,onReset:P},null,8,["initialData","submitButtonText","loading"])])]),_:1},8,["title"])])]),_:1}))}};export{x as default};
