import{r as e,m as t,o as a,j as r,k as s,q as o,b as l,c as i,t as g,f as n,C as c,B as u,e as d}from"./index-BChQAjBg.js";import{_ as y}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as m}from"./AdminLayout-BDbNDvIA.js";import{_ as p}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{L as x}from"./LazyImage-BMawgtWq.js";import{D as v}from"./DataTable-D4TLCeTz.js";import{C as f}from"./CategoriesAPI-CbxhYl7H.js";import{S as h}from"./SubcategoriesAPI-C_blSPdt.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ErrorIcon-CRM2J8oG.js";const b={class:"space-y-5 sm:space-y-6"},_={key:0,class:"flex justify-center items-center py-8"},k={key:1,class:"text-center py-8"},w={key:2,class:"space-y-6"},C={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},A={class:"space-y-4"},j={class:"text-lg text-gray-900 dark:text-white"},S={class:"text-lg text-gray-900 dark:text-white"},I={class:"text-lg text-gray-900 dark:text-white"},D={class:"space-y-4"},E={class:"text-lg text-gray-900 dark:text-white"},L={class:"text-lg text-gray-900 dark:text-white"},B={key:0},N={class:"font-medium text-gray-800 dark:text-white"},$={class:"text-sm text-gray-500 dark:text-gray-400"},q={__name:"ViewCategory",setup(q){const P=c(),T=u(),F=e(null),M=e([]),V=e(!0),z=t(()=>F.value?`Category: ${F.value.name.en}`:"Category Details"),U=[{key:"name",title:"Name"},{key:"slug",title:"Slug"},{key:"createdAt",title:"Created At"}],G=async()=>{try{if(!F.value||!F.value._id)return void console.error("Category or category ID is missing");console.log("Fetching subcategories for categoryId:",F.value._id);const e=await h.getAllSubcategories(F.value._id);console.log("Subcategories response:",e),M.value=e.data.data.subcategories,console.log("Mapped subcategories:",M.value)}catch(e){console.error("Error fetching subcategories:",e)}},H=e=>new Date(e).toLocaleDateString(),J=()=>{T.push(`/categories/edit/${F.value._id}`)},K=()=>{T.push("/categories")},O=()=>{T.push({path:"/subcategories/edit/new",query:{category:F.value._id}})},Q=e=>{T.push(`/subcategories/view/${e._id}`)},R=e=>{T.push({path:`/subcategories/edit/${e._id}`,query:{category:F.value._id}})},W=async e=>{if(confirm("Are you sure you want to delete this subcategory?"))try{const t=localStorage.getItem("token");await h.deleteSubcategory(F.value._id,e._id,t),await G()}catch(t){console.error("Error deleting subcategory:",t)}};return a(()=>{(async()=>{try{console.log("Fetching all categories…");const e=await f.getAllCategories();console.log("Categories response:",e);const t=e.data.data.categories;console.log("Extracted categories array:",t),F.value=t.find(e=>e._id===P.params.id),console.log("Matched category by _id:",F.value),F.value?(console.log("Category found, fetching subcategories…"),await G()):console.warn("No category matched the given route id:",P.params.id)}catch(e){console.error("Error fetching category:",e)}finally{V.value=!1}})()}),(e,t)=>(d(),r(m,null,{default:s(()=>[o(y,{pageTitle:z.value},null,8,["pageTitle"]),l("div",b,[o(p,{title:"Category Details"},{default:s(()=>[V.value?(d(),i("div",_,[...t[0]||(t[0]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"},null,-1),l("span",{class:"ml-2 text-gray-500"},"Loading category details...",-1)])])):F.value?(d(),i("div",w,[l("div",C,[l("div",A,[l("div",null,[t[2]||(t[2]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Name (English)",-1)),l("p",j,g(F.value.name.en),1)]),l("div",null,[t[3]||(t[3]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Name (Arabic)",-1)),l("p",S,g(F.value.name.ar),1)]),l("div",null,[t[4]||(t[4]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Slug",-1)),l("p",I,g(F.value.slug),1)])]),l("div",D,[l("div",null,[t[5]||(t[5]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Created At",-1)),l("p",E,g(H(F.value.createdAt)),1)]),l("div",null,[t[6]||(t[6]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Updated At",-1)),l("p",L,g(H(F.value.updatedAt)),1)]),F.value.Image?(d(),i("div",B,[t[7]||(t[7]=l("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Image",-1)),o(x,{"image-id":F.value.Image,alt:F.value.name.en,width:"128px",height:"128px","image-class":"w-32 h-32 object-cover rounded-lg",placeholder:"/placeholder-category.png"},null,8,["image-id","alt"])])):n("",!0)])]),l("div",{class:"flex gap-4 pt-4 border-t border-gray-200 dark:border-gray-700"},[l("button",{onClick:J,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200"}," Edit Category "),l("button",{onClick:K,class:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200"}," Back to Categories ")])])):(d(),i("div",k,[t[1]||(t[1]=l("p",{class:"text-red-500 text-lg"},"Category not found",-1)),l("button",{onClick:K,class:"mt-4 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200"}," Back to Categories ")]))]),_:1}),o(p,{title:"Subcategories"},{default:s(()=>[l("div",{class:"mb-4 flex justify-between items-center"},[t[8]||(t[8]=l("h3",{class:"text-lg font-medium text-gray-800 dark:text-white"},"Subcategories List",-1)),l("button",{onClick:O,class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors duration-200"}," Add Subcategory ")]),o(v,{columns:U,data:M.value,showActions:!0,onView:Q,onEdit:R,onDelete:W},{"column-name":s(({item:e})=>[l("div",null,[l("p",N,g(e.name.en),1),l("p",$,g(e.name.ar),1)])]),_:1},8,["data"])]),_:1})])]),_:1}))}};export{q as default};
