import{d as e,r as t,m as a,o as r,j as l,k as s,a as u,q as o,b as i,B as d,e as n}from"./index-BChQAjBg.js";import{_ as c}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as p}from"./AdminLayout-BDbNDvIA.js";import{_ as m}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{_ as v}from"./Form.vue_vue_type_script_setup_true_lang-Dj0hsM9h.js";import{C as _}from"./CartsAPI-2yBGA81K.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";const y={class:"space-y-6"},b=e({__name:"AddCart",setup(e){const b=d(),f=t("Add Cart"),C=t(!1),h=t([]),g=t([]),I=t({userId:"",cartItem:[]}),A=a(()=>[{key:"userId",type:"select",label:"Customer",required:!0,placeholder:"Select a customer",options:Array.isArray(h.value)?h.value.map(e=>({label:`${e.name} (${e.email})`,value:e._id})):[]},{key:"cartItem",type:"array",label:"Cart Items",required:!0,minItems:1,addButtonText:"+ Add Item",itemLabel:"Item",emptyMessage:'No items added. Click "Add Item" to start.',fields:[{key:"productId",type:"select",label:"Product",required:!0,placeholder:"Select a product",options:Array.isArray(g.value)?g.value.map(e=>{var t;return{label:(null==(t=e.title)?void 0:t.en)||e.name||"Unknown",value:e._id}}):[]},{key:"quantity",type:"number",label:"Quantity",required:!0,min:1,placeholder:"1"}]}]),j=async()=>{var e;try{const{data:t}=await u.get("/users");h.value=(null==(e=null==t?void 0:t.data)?void 0:e.users)||(null==t?void 0:t.users)||(null==t?void 0:t.data)||[]}catch(t){console.error("Failed to fetch users:",t)}},w=async()=>{var e;try{const{data:t}=await u.get("/products");g.value=(null==(e=null==t?void 0:t.data)?void 0:e.products)||(null==t?void 0:t.products)||(null==t?void 0:t.data)||[]}catch(t){console.error("Failed to fetch products:",t)}},k=async e=>{C.value=!0;try{await _.createCart(e),b.push("/carts")}catch(t){console.error("Failed to create cart:",t)}finally{C.value=!1}},q=()=>{b.push("/carts")};return r(async()=>{await Promise.all([j(),w()])}),(e,t)=>(n(),l(p,null,{default:s(()=>[o(c,{pageTitle:f.value},null,8,["pageTitle"]),i("div",y,[o(m,{title:"Create New Cart"},{default:s(()=>[o(v,{fields:A.value,"initial-data":I.value,"show-submit-button":!0,"submit-button-text":"Create Cart","show-reset-button":!0,"reset-button-text":"Cancel",loading:C.value,onSubmit:k,onReset:q},null,8,["fields","initial-data","loading"])]),_:1})])]),_:1}))}});export{b as default};
