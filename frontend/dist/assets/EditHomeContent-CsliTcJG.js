import{r as e,m as t,C as o,o as r,j as a,k as d,q as n,b as l,G as i,c as s,w as u,I as c,i as m,t as g,A as p,F as b,f as y,E as f,B as x,e as v}from"./index-BChQAjBg.js";import{_ as k}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as h}from"./AdminLayout-BDbNDvIA.js";import{_ as w}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{H as _}from"./HomeContentAPI-BYo-OVBa.js";import{P as S}from"./ProductsAPI-MABK5z0-.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";const A={class:"space-y-5 sm:space-y-6"},C={class:"flex items-center space-x-3"},D={class:"text-lg font-medium text-gray-800 dark:text-white"},I={class:"flex items-center space-x-3"},U=["id","onUpdate:modelValue"],V=["for"],E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j=["onUpdate:modelValue"],q=["onUpdate:modelValue"],H={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},P=["onUpdate:modelValue"],$=["onUpdate:modelValue"],T={class:"space-y-4"},B={class:"flex justify-between items-center"},J=["onClick"],N={class:"flex justify-between items-center"},O={class:"font-medium text-gray-700 dark:text-gray-300"},F=["onClick"],G=["onUpdate:modelValue","onChange"],L={key:0},R=["onUpdate:modelValue"],z=["value"],K={key:1,class:"space-y-3"},M={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q=["onUpdate:modelValue"],W=["onUpdate:modelValue"],X={class:"flex justify-end space-x-3"},Y=["disabled"],Z={__name:"EditHomeContent",setup(Z){const ee=x(),te=o(),oe=e(!1),re=e([]),ae=t(()=>!!te.params.id),de=t(()=>ae.value?"Edit Home Content":"Add Home Content"),ne=e({isActive:!0,sections:[{title:{en:"",ar:""},description:{en:"",ar:""},items:[],isActive:!0},{title:{en:"",ar:""},description:{en:"",ar:""},items:[],isActive:!0}]}),le=async()=>{try{const e=await S.getAllProducts();re.value=e.data.data.products}catch(e){console.error("Error fetching products:",e)}},ie=async()=>{if(ae.value)try{const e=(await _.getHomeContentById(te.params.id)).data.data.homeContent;e.sections.forEach(e=>{e.items.forEach(e=>{"coming_soon"===e.type?e.comingSoonData||(e.comingSoonData={title:{en:"",ar:""}}):"product"===e.type&&(e.productId&&"object"==typeof e.productId&&e.productId._id&&(e.productId=e.productId._id),e.comingSoonData||(e.comingSoonData={title:{en:"",ar:""}}))})}),ne.value=e}catch(e){console.error("Error fetching home content:",e)}},se=async()=>{if((()=>{for(let e=0;e<ne.value.sections.length;e++){const t=ne.value.sections[e];if(!t.title.en.trim()||!t.title.ar.trim())return alert(`Section ${e+1}: Title is required in both languages`),!1;if(!t.description.en.trim()||!t.description.ar.trim())return alert(`Section ${e+1}: Description is required in both languages`),!1;for(let o=0;o<t.items.length;o++){const r=t.items[o];if("product"===r.type&&!r.productId)return alert(`Section ${e+1}, Item ${o+1}: Product selection is required`),!1;if("coming_soon"===r.type&&!(r.comingSoonData&&r.comingSoonData.title&&r.comingSoonData.title.en.trim()&&r.comingSoonData.title.ar.trim()))return alert(`Section ${e+1}, Item ${o+1}: Coming soon title is required in both languages`),!1}}return!0})()){oe.value=!0;try{const e=(()=>{const e=JSON.parse(JSON.stringify(ne.value));return delete e._id,delete e.createdBy,delete e.createdAt,delete e.updatedAt,delete e.__v,delete e.id,e.sections.forEach(e=>{e.items.forEach(e=>{"product"===e.type?delete e.comingSoonData:"coming_soon"===e.type&&(delete e.productId,e.comingSoonData||(e.comingSoonData={title:{en:"",ar:""}}))})}),e})();ae.value?await _.updateHomeContent(te.params.id,e):await _.createHomeContent(e),ee.push("/admin/home-content")}catch(e){console.error("Error saving home content:",e),alert("Error saving home content")}finally{oe.value=!1}}};return r(async()=>{await Promise.all([le(),ie()])}),(e,t)=>(v(),a(h,null,{default:d(()=>[n(k,{pageTitle:de.value},null,8,["pageTitle"]),l("div",A,[n(w,{title:ae.value?"Edit Home Content":"Add Home Content"},{default:d(()=>[l("form",{onSubmit:i(se,["prevent"]),class:"space-y-6"},[l("div",C,[u(l("input",{type:"checkbox",id:"isActive","onUpdate:modelValue":t[0]||(t[0]=e=>ne.value.isActive=e),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"},null,512),[[c,ne.value.isActive]]),t[2]||(t[2]=l("label",{for:"isActive",class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Active ",-1))]),(v(!0),s(b,null,m(ne.value.sections,(e,o)=>(v(),s("div",{key:o,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-6 space-y-4"},[l("h3",D," Section "+g(o+1),1),l("div",I,[u(l("input",{type:"checkbox",id:`section-${o}-active`,"onUpdate:modelValue":t=>e.isActive=t,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"},null,8,U),[[c,e.isActive]]),l("label",{for:`section-${o}-active`,class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Section Active ",8,V)]),l("div",E,[l("div",null,[t[3]||(t[3]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title (English) ",-1)),u(l("input",{type:"text","onUpdate:modelValue":t=>e.title.en=t,required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,j),[[p,e.title.en]])]),l("div",null,[t[4]||(t[4]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title (Arabic) ",-1)),u(l("input",{type:"text","onUpdate:modelValue":t=>e.title.ar=t,required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,q),[[p,e.title.ar]])])]),l("div",H,[l("div",null,[t[5]||(t[5]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description (English) ",-1)),u(l("textarea",{"onUpdate:modelValue":t=>e.description.en=t,required:"",rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,P),[[p,e.description.en]])]),l("div",null,[t[6]||(t[6]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description (Arabic) ",-1)),u(l("textarea",{"onUpdate:modelValue":t=>e.description.ar=t,required:"",rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,$),[[p,e.description.ar]])])]),l("div",T,[l("div",B,[t[7]||(t[7]=l("h4",{class:"text-md font-medium text-gray-800 dark:text-white"},"Items",-1)),l("button",{type:"button",onClick:e=>(e=>{ne.value.sections[e].items.push({type:"product",productId:"",comingSoonData:{title:{en:"",ar:""}}})})(o),class:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-sm"}," Add Item ",8,J)]),(v(!0),s(b,null,m(e.items,(e,r)=>(v(),s("div",{key:r,class:"border border-gray-100 dark:border-gray-600 rounded p-4 space-y-3"},[l("div",N,[l("h5",O,"Item "+g(r+1),1),l("button",{type:"button",onClick:e=>((e,t)=>{ne.value.sections[e].items.splice(t,1)})(o,r),class:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm"}," Remove ",8,F)]),l("div",null,[t[9]||(t[9]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Item Type ",-1)),u(l("select",{"onUpdate:modelValue":t=>e.type=t,onChange:e=>((e,t)=>{const o=ne.value.sections[e].items[t];"product"===o.type?(o.productId="",delete o.comingSoonData):"coming_soon"===o.type&&(delete o.productId,o.comingSoonData||(o.comingSoonData={title:{en:"",ar:""}}))})(o,r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[...t[8]||(t[8]=[l("option",{value:"product"},"Product",-1),l("option",{value:"coming_soon"},"Coming Soon",-1)])],40,G),[[f,e.type]])]),"product"===e.type?(v(),s("div",L,[t[11]||(t[11]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Select Product ",-1)),u(l("select",{"onUpdate:modelValue":t=>e.productId=t,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[t[10]||(t[10]=l("option",{value:""},"Select a product",-1)),(v(!0),s(b,null,m(re.value,e=>(v(),s("option",{key:e._id,value:e._id},g(e.title.en)+" - "+g(e.title.ar),9,z))),128))],8,R),[[f,e.productId]])])):y("",!0),"coming_soon"===e.type?(v(),s("div",K,[l("div",M,[l("div",null,[t[12]||(t[12]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title (English) ",-1)),u(l("input",{type:"text","onUpdate:modelValue":t=>e.comingSoonData.title.en=t,required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,Q),[[p,e.comingSoonData.title.en]])]),l("div",null,[t[13]||(t[13]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title (Arabic) ",-1)),u(l("input",{type:"text","onUpdate:modelValue":t=>e.comingSoonData.title.ar=t,required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,8,W),[[p,e.comingSoonData.title.ar]])])])])):y("",!0)]))),128))])]))),128)),l("div",X,[l("button",{type:"button",onClick:t[1]||(t[1]=t=>e.$router.go(-1)),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Cancel "),l("button",{type:"submit",disabled:oe.value,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"},g(oe.value?"Saving...":ae.value?"Update":"Create"),9,Y)])],32)]),_:1},8,["title"])])]),_:1}))}};export{Z as default};
