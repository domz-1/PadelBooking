import{d as e,r as t,z as a,o,j as r,k as s,q as n,b as l,c as i,f as u,w as d,A as g,t as c,n as p,B as m,e as y}from"./index-BChQAjBg.js";import{B as k}from"./BookingsAPI-BPIiesDV.js";import{_ as b}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as v}from"./AdminLayout-BDbNDvIA.js";import{_ as x}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{D as f}from"./DataTable-D4TLCeTz.js";import{_ as h}from"./Pagination-D-pp1c0D.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ErrorIcon-CRM2J8oG.js";const w={class:"space-y-5 sm:space-y-6"},_={class:"mb-4"},P={class:"relative"},j={key:0,class:"flex justify-center items-center py-12"},B={class:"block font-medium text-gray-800 text-sm dark:text-white/90"},T={class:"block text-gray-500 text-xs dark:text-gray-400"},A={class:"text-gray-800 dark:text-white text-sm"},D=e({__name:"Bookings",setup(e){const D=m(),U=t("Bookings"),C=t([]),E=t(!1),V=t(""),I=t({currentPage:1,totalPages:1,totalDocuments:0,hasNextPage:!1,hasPrevPage:!1,limit:10}),S=[{key:"id",title:"ID",type:"text"},{key:"date",title:"Date",type:"text"},{key:"startTime",title:"Start Time",type:"text"},{key:"endTime",title:"End Time",type:"text"},{key:"user",title:"User",type:"custom"},{key:"venue",title:"Venue",type:"custom"},{key:"status",title:"Status",type:"status"},{key:"totalPrice",title:"Price",type:"text"}],$=async()=>{E.value=!0;try{const e={page:I.value.currentPage,limit:I.value.limit},t=await k.getAllBookings(e);t.data.data&&(C.value=t.data.data.bookings||t.data.data,t.data.pagination?I.value=t.data.pagination:t.data.data.pagination&&(I.value=t.data.data.pagination))}catch(e){console.error("Error fetching bookings:",e)}finally{E.value=!1}},q=e=>{I.value.currentPage=e,$()},z=e=>{const t={confirmed:"bg-green-50 text-green-700 dark:bg-green-500/15 dark:text-green-500",pending:"bg-yellow-50 text-yellow-700 dark:bg-yellow-500/15 dark:text-yellow-400",cancelled:"bg-red-50 text-red-700 dark:bg-red-500/15 dark:text-red-500","pending-coach":"bg-blue-50 text-blue-700 dark:bg-blue-500/15 dark:text-blue-500","no-show":"bg-gray-50 text-gray-700 dark:bg-gray-500/15 dark:text-gray-500"};return`rounded-full px-2 py-0.5 text-theme-xs font-medium ${t[e]||t.pending}`},M=()=>{D.push("/bookings/add")},N=e=>{D.push(`/bookings/view/${e.id}`)},F=e=>{D.push(`/bookings/edit/${e.id}`)},L=async e=>{if(confirm("Are you sure you want to delete this booking?"))try{await k.deleteBooking(e.id),$()}catch(t){console.error("Error deleting booking:",t),alert("Failed to delete booking")}};let G;return a(V,()=>{clearTimeout(G),G=setTimeout(()=>{I.value.currentPage=1,$()},500)}),o(()=>{$()}),(e,t)=>(y(),r(v,null,{default:s(()=>[n(b,{pageTitle:U.value},null,8,["pageTitle"]),l("div",w,[n(x,{title:"Bookings Management"},{default:s(()=>[l("div",{class:"mb-4 flex justify-between items-center"},[t[1]||(t[1]=l("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"},"All Bookings",-1)),l("button",{onClick:M,class:"px-4 py-2 bg-brand-500 text-white rounded-lg hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2"}," Add Booking ")]),l("div",_,[l("div",P,[d(l("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),type:"text",placeholder:"Search bookings...",class:"w-full px-4 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-brand-500"},null,512),[[g,V.value]]),t[2]||(t[2]=l("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),E.value?(y(),i("div",j,[...t[3]||(t[3]=[l("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"},null,-1)])])):(y(),r(f,{key:1,columns:S,data:C.value,showActions:!0,onView:N,onEdit:F,onDelete:L},{"column-status":s(({item:e})=>[l("span",{class:p(z(e.status))},c(e.status),3)]),"column-user":s(({item:e})=>{var t,a;return[l("div",null,[l("span",B,c((null==(t=e.User)?void 0:t.name)||"Unknown"),1),l("span",T,c(null==(a=e.User)?void 0:a.email),1)])]}),"column-venue":s(({item:e})=>{var t;return[l("span",A,c((null==(t=e.Venue)?void 0:t.name)||"Unknown"),1)]}),_:1},8,["data"])),I.value.totalPages>1?(y(),r(h,{key:2,"current-page":I.value.currentPage,"total-pages":I.value.totalPages,"total-documents":I.value.totalDocuments,limit:I.value.limit,"has-next-page":I.value.hasNextPage,"has-prev-page":I.value.hasPrevPage,onPageChange:q},null,8,["current-page","total-pages","total-documents","limit","has-next-page","has-prev-page"])):u("",!0)]),_:1})])]),_:1}))}});export{D as default};
