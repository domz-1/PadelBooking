import{u as e,r as t,o as a,j as s,k as o,q as r,b as n,f as l,t as u,n as i,B as d,e as p}from"./index-BChQAjBg.js";import{C as c}from"./CouponsAPI-B3DH21Q0.js";import{_ as m}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiMPynWi.js";import{_ as g}from"./AdminLayout-BDbNDvIA.js";import{_ as x}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CxALZE3h.js";import{D as v}from"./DataTable-D4TLCeTz.js";import{_ as f}from"./Pagination-D-pp1c0D.js";import"./helpers-BbRepCn0.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ErrorIcon-CRM2J8oG.js";const y={class:"space-y-5 sm:space-y-6"},h={class:"mb-4 flex justify-between items-center"},b={class:"text-lg font-semibold text-gray-800 dark:text-white"},_={class:"flex items-center gap-3"},k={class:"w-10 h-10 overflow-hidden rounded-full bg-brand-100 dark:bg-brand-500/15 flex items-center justify-center"},w={class:"text-sm font-medium text-brand-600 dark:text-brand-400"},P={class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90"},C={class:"block text-gray-500 text-theme-xs dark:text-gray-400"},j={class:"font-semibold text-brand-600 dark:text-brand-400"},A={__name:"Coupons",setup(A){const D=d(),E=e(),T=t("Coupons"),$=t([]),B=t(!1),F=t({currentPage:1,totalPages:1,totalDocuments:0,hasNextPage:!1,hasPrevPage:!1,limit:10}),I=[{key:"code",title:"Code",type:"text"},{key:"discount",title:"Discount",type:"text"},{key:"expires",title:"Expires",type:"text"},{key:"status",title:"Status",type:"status"},{key:"createdAt",title:"Created",type:"text"}],L=async()=>{var e;B.value=!0;try{const t={page:F.value.currentPage,limit:F.value.limit},a=await c.getAllCoupons(E.token,t);if(null==(e=a.data)?void 0:e.data){const e=a.data.data.coupons||[];$.value=e.map(e=>({...e,createdAt:N(e.createdAt),expires:e.expires})),a.data.data.pagination&&(F.value={...a.data.data.pagination})}}catch(t){console.error("Error fetching coupons:",t),$.value=[]}finally{B.value=!1}},M=e=>{F.value.currentPage=e,L()},N=e=>new Date(e).toLocaleDateString(),S=e=>{const t=new Date;return new Date(e.expires)<t?"Expired":"Active"},q=e=>{const t=new Date,a=new Date(e),s=Math.ceil((a-t)/864e5);return s<0?"text-red-600 dark:text-red-400 font-medium":s<=7?"text-yellow-600 dark:text-yellow-400 font-medium":"text-gray-500 dark:text-gray-400"},O=()=>{D.push("/coupons/edit/new")},U=e=>{D.push(`/coupons/view/${e._id}`)},V=e=>{D.push(`/coupons/edit/${e._id}`)},z=async e=>{if(confirm(`Are you sure you want to delete coupon ${e.code}?`))try{await c.deleteCoupon(e._id,E.token),await L()}catch(t){console.error("Error deleting coupon:",t)}};return a(()=>{L()}),(e,t)=>(p(),s(g,null,{default:o(()=>[r(m,{pageTitle:T.value},null,8,["pageTitle"]),n("div",y,[r(x,{title:"Coupon Management"},{default:o(()=>[n("div",h,[n("h3",b," All Coupons ("+u(F.value.totalDocuments)+") ",1),n("button",{onClick:O,class:"px-4 py-2 bg-brand-500 text-white rounded-lg hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2"}," Add Coupon ")]),r(v,{columns:I,data:$.value,showActions:!0,onView:U,onEdit:V,onDelete:z},{"column-code":o(({item:e})=>[n("div",_,[n("div",k,[n("span",w,u(e.code.charAt(0).toUpperCase()),1)]),n("div",null,[n("span",P,u(e.code),1),n("span",C,u(e.discount)+"% OFF ",1)])])]),"column-discount":o(({item:e})=>[n("span",j,u(e.discount)+"% ",1)]),"column-expires":o(({item:e})=>[n("span",{class:i(q(e.expires))},u(N(e.expires)),3)]),"column-status":o(({item:e})=>{return[n("span",{class:i((t=e,"Active"===S(t)?"bg-green-50 text-green-700 dark:bg-green-500/15 dark:text-green-500 rounded-full px-2 py-0.5 text-theme-xs font-medium":"bg-red-50 text-red-700 dark:bg-red-500/15 dark:text-red-500 rounded-full px-2 py-0.5 text-theme-xs font-medium"))},u(S(e)),3)];var t}),_:1},8,["data"]),F.value.totalPages>1?(p(),s(f,{key:0,"current-page":F.value.currentPage,"total-pages":F.value.totalPages,"total-documents":F.value.totalDocuments,limit:F.value.limit,"has-next-page":F.value.hasNextPage,"has-prev-page":F.value.hasPrevPage,onPageChange:M},null,8,["current-page","total-pages","total-documents","limit","has-next-page","has-prev-page"])):l("",!0)]),_:1})])]),_:1}))}};export{A as default};
